<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.9">
<meta name="Forrest-skin-name" content="pelt">
<title>Installation </title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href=""><img class="logoImage" alt="HCatalog" src="images/hcat.jpg" title=""></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogoA1">
<a href=""><img class="logoImage" alt="HCatalog" src="images/hcat-box.jpg" title="A table abstraction on top of data for use with java MapReduce programs, Pig scripts and Hive queryies."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li class="current">
<a class="selected" href="index.html">HCatalog 0.5.0 Documentation</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">HCatalog</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html">Overview</a>
</div>
<div class="menuitem">
<a href="install.html">Installation From Tarball</a>
</div>
<div class="menuitem">
<a href="loadstore.html">Load &amp; Store Interfaces</a>
</div>
<div class="menuitem">
<a href="inputoutput.html">Input &amp; Output Interfaces</a>
</div>
<div class="menuitem">
<a href="readerwriter.html">Reader &amp; Writer Interfaces</a>
</div>
<div class="menuitem">
<a href="cli.html">Command Line Interface</a>
</div>
<div class="menuitem">
<a href="supportedformats.html">Storage Formats</a>
</div>
<div class="menuitem">
<a href="dynpartition.html">Dynamic Partitioning</a>
</div>
<div class="menuitem">
<a href="notification.html">Notification</a>
</div>
<div class="menuitem">
<a href="authorization.html">Authorization</a>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.11', 'skin/')" id="menu_selected_1.1.11Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">WebHCat</div>
<div id="menu_selected_1.1.11" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="rest.html">Overview</a>
</div>
<div class="menupage">
<div class="menupagetitle">Installation</div>
</div>
<div class="menuitem">
<a href="configuration.html">Configuration</a>
</div>
<div onclick="SwitchMenu('menu_1.1.11.4', 'skin/')" id="menu_1.1.11.4Title" class="menutitle">Reference</div>
<div id="menu_1.1.11.4" class="menuitemgroup">
<div class="menuitem">
<a href="resources.html">Resource List</a>
</div>
<div class="menuitem">
<a href="responsetypes.html">:version</a>
</div>
<div class="menuitem">
<a href="status.html">status</a>
</div>
<div class="menuitem">
<a href="versions.html">version</a>
</div>
<div onclick="SwitchMenu('menu_1.1.11.4.5', 'skin/')" id="menu_1.1.11.4.5Title" class="menutitle">ddl</div>
<div id="menu_1.1.11.4.5" class="menuitemgroup">
<div class="menuitem">
<a href="ddlsummary.html">ddl (summary)</a>
</div>
<div class="menuitem">
<a href="ddl.html">ddl</a>
</div>
<div class="menuitem">
<a href="listdbs.html">database</a>
</div>
<div class="menuitem">
<a href="descdb.html">:db (GET)</a>
</div>
<div class="menuitem">
<a href="createdb.html">:db (PUT)</a>
</div>
<div class="menuitem">
<a href="deletedb.html">:db (DELETE)</a>
</div>
<div class="menuitem">
<a href="listtables.html">table</a>
</div>
<div class="menuitem">
<a href="desctable.html">:table (GET)</a>
</div>
<div class="menuitem">
<a href="createtable.html">:table (PUT)</a>
</div>
<div class="menuitem">
<a href="renametable.html">:table (POST)</a>
</div>
<div class="menuitem">
<a href="deletetable.html">:table (DELETE)</a>
</div>
<div class="menuitem">
<a href="createtablelike.html">like/:table (PUT)</a>
</div>
<div class="menuitem">
<a href="listpartitions.html">partition</a>
</div>
<div class="menuitem">
<a href="descpartition.html">:partition (GET)</a>
</div>
<div class="menuitem">
<a href="createpartition.html">:partition (PUT)</a>
</div>
<div class="menuitem">
<a href="deletepartition.html">:partition (DELETE)</a>
</div>
<div class="menuitem">
<a href="listcolumns.html">column</a>
</div>
<div class="menuitem">
<a href="desccolumn.html">:column (GET)</a>
</div>
<div class="menuitem">
<a href="createcolumn.html">:column (PUT)</a>
</div>
<div class="menuitem">
<a href="listproperties.html">property</a>
</div>
<div class="menuitem">
<a href="descproperty.html">:property (GET)</a>
</div>
<div class="menuitem">
<a href="addproperty.html">:property (PUT)</a>
</div>
</div>
<div class="menuitem">
<a href="mapreducestreaming.html">mapreduce/streaming</a>
</div>
<div class="menuitem">
<a href="mapreducejar.html">mapreduce/jar</a>
</div>
<div class="menuitem">
<a href="pig.html">pig</a>
</div>
<div class="menuitem">
<a href="hive.html">hive</a>
</div>
<div class="menuitem">
<a href="queuelist.html">queue</a>
</div>
<div class="menuitem">
<a href="queue.html">:jobid (GET)</a>
</div>
<div class="menuitem">
<a href="queuedelete.html">:jobid (DELETE)</a>
</div>
</div>
</div>
<div class="menuitem">
<a href="api/index.html">API Docs</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="rest_server_install.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Installation </h1>
<div id="front-matter">
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Procedure">Procedure</a>
</li>
<li>
<a href="#Server+Commands">Server Commands</a>
</li>
<li>
<a href="#Requirements">Requirements</a>
</li>
<li>
<a href="#Hadoop+Distributed+Cache">Hadoop Distributed Cache</a>
</li>
<li>
<a href="#Permissions">Permissions</a>
</li>
<li>
<a href="#Secure+Cluster">Secure Cluster</a>
</li>
</ul>
</div>
</div>

  
<a name="Procedure"></a>
<h2 class="h3">Procedure</h2>
<div class="section">
<ol>
  
<li>Ensure that the
       <a href="rest_server_install.html#Requirements">required related installations</a>
      are in place, and place required files into the
      <a href="rest_server_install.html#Hadoop+Distributed+Cache">Hadoop distributed cache.</a>
</li>
  
<li>Download and unpack the HCatalog distribution.</li>
  
<li>Set the <span class="codefrag">TEMPLETON_HOME</span> environment variable to the base of the
      HCatalog REST server installation.  This will usually be same as
       <span class="codefrag">HCATALOG_HOME</span>.
      This is used to find the Templeton
      configuration.</li>
  
<li>Set JAVA_HOME,HADOOP_PREFIX, and HIVE_HOME environment variables</li>
  
<li>Review the <a href="configuration.html">configuration</a>
      and update or create <span class="codefrag">webhcat-site.xml</span> as required. Ensure that
      site specific component installation locations are accurate, especially
      the Hadoop configuration path.  Configuration variables that use a filesystem
      path try to have reasonable defaults, but it's always safe to specify a full
      and complete path.</li>
  
<li>Verify that HCatalog is installed and that the <span class="codefrag">hcat</span>
      executable is in the PATH.</li>
  
<li>Build HCatalog using the command <span class="codefrag">ant jar</span> from the
      top level HCatalog directory.</li>
  
<li>Start the REST server with the command
      <span class="codefrag">sbin/webhcat_server.sh start</span>.</li>
  
<li>Check that your local install works.  Assuming that the server is running
      on port 50111, the following command would give output similar to that shown.
<pre class="code">
% curl -i http://localhost:50111/templeton/v1/status
HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked
Server: Jetty(7.6.0.v20120127)

{"status":"ok","version":"v1"}
%
</pre>
</li>
  
</ol>
</div>

  
<a name="Server+Commands"></a>
<h2 class="h3">Server Commands</h2>
<div class="section">
<ul>
   
<li>
<strong>Start the server:</strong> <span class="codefrag">sbin/webhcat_server.sh start</span>
</li>
   
<li>
<strong>Stop the server:</strong> <span class="codefrag">sbin/webhcat_server.sh stop</span>
</li>
   
<li>
<strong>End-to-end build, run, test:</strong> <span class="codefrag">ant e2e</span>
</li>
  
</ul>
</div>

  
<a name="Requirements"></a>
<h2 class="h3">Requirements</h2>
<div class="section">
<ul>
   
<li>
<a href="http://ant.apache.org/">Ant</a>, version 1.8 or higher</li>
   
<li>
<a href="http://hadoop.apache.org/">Hadoop</a>, version 1.0.3 or higher</li>
   
<li>
<a href="http://zookeeper.apache.org/">ZooKeeper</a> is required if you are using
    the ZooKeeper storage class. (Be sure to review
    and update the ZooKeeper related <a href="configuration.html">Templeton
    configuration</a>.)</li>
   
<li>
     
<a href="http://incubator.apache.org/hcatalog/">HCatalog</a>.
     Version 0.5.0 or higher.  The hcat executable must be both in the
     PATH and properly configured in the <a href="configuration.html">Templeton configuration</a>.
   </li>
   
<li>
     Permissions must be given to the user running the server.
     (see below)
   </li>
   
<li>
     If running a secure cluster, Kerberos keys and principals must be
     created.  (see below)
   </li>
   
<li>
<a href="rest_server_install.html#Hadoop+Distributed+Cache">Hadoop Distributed Cache</a>.
    To use the <a href="http://hive.apache.org/">Hive</a>,
    <a href="http://pig.apache.org/">Pig</a>, or
    <a href="http://hadoop.apache.org/common/docs/r1.0.0/streaming.html">hadoop/streaming</a>
    resources, see instructions below for placing the required files in the
    Hadoop Distributed Cache.</li>
  
</ul>
</div>

  
<a name="Hadoop+Distributed+Cache"></a>
<h2 class="h3">Hadoop Distributed Cache</h2>
<div class="section">
<p>The server requires some files be accessible on the
  <a href="http://hadoop.apache.org/common/docs/current/mapred_tutorial.html#DistributedCache">
   Hadoop distributed cache</a>.  For example, to avoid the installation of Pig and Hive
   everywhere on the cluster, the server gathers a version of Pig or Hive from the
   Hadoop distributed cache whenever those resources are invoked. After placing the
   following components into HDFS please update the site configuration as required for
   each.</p>
<ul>
  
<li>
<strong>Hive</strong>:
   <a href="http://www.apache.org/dyn/closer.cgi/hive/">Download</a>
   the hive tar.gz file and place it in HDFS. 
<pre class="code">
hadoop fs -put /tmp/hive-0.10.0.tar.gz /apps/templeton/hive-0.10.0.tar.gz
</pre>
  
</li>

  
<li>
<strong>Pig</strong>:
   <a href="http://www.apache.org/dyn/closer.cgi/pig">Download</a>
   the Pig tar.gz file and place it into HDFS.  For example:
<pre class="code">
hadoop fs -put /tmp/pig-0.10.1.tar.gz /apps/templeton/pig-0.10.1.tar.gz
</pre>
  
</li>

  
<li>
<strong>Hadoop Streaming</strong>:
   Place <span class="codefrag">hadoop-streaming.jar</span> into HDFS. For example, use the
   following command, substituting your path to the jar for the one below.
<pre class="code">
hadoop fs -put $HADOOP_PREFIX/hadoop-0.20.205.0/contrib/streaming/hadoop-streaming-0.20.205.0.jar \
 /apps/templeton/hadoop-streaming.jar
</pre>
  
</li>

  
<li>
<strong>Override Jars</strong>:
   Place override jars required (if any) into HDFS. <em>Note</em>: Hadoop versions
   prior to 1.0.3 require a patch (HADOOP-7987) to properly run Templeton.  This patch is
   distributed with Templeton (located at
   <span class="codefrag">templeton/src/hadoop_temp_fix/ugi.jar</span>)
   and should be placed into HDFS, as reflected in the current default configuration.
<pre class="code">
hadoop fs -put ugi.jar /apps/templeton/ugi.jar
</pre>
  
</li>
  
</ul>
<p>The location of these files in the cache, and the location
     of the installations inside the archives, can be specified using the following
     Templeton configuration variables.  (See the
     <a href="configuration.html">Configuration</a> documentation for more information
     on changing Templeton configuration parameters.)</p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
  
<tr>
<th colspan="1" rowspan="1">Name</th><th colspan="1" rowspan="1">Default</th><th colspan="1" rowspan="1">Description</th>
</tr>

  
<tr>
    
<td colspan="1" rowspan="1"><strong>templeton.pig.archive</strong></td>
    <td colspan="1" rowspan="1"><span class="codefrag">hdfs:///apps/templeton/pig-0.10.1.tar.gz</span></td>
    <td colspan="1" rowspan="1">The path to the Pig archive.</td>
  
</tr>

  
<tr>
    
<td colspan="1" rowspan="1"><strong>templeton.pig.path</strong></td>
    <td colspan="1" rowspan="1"><span class="codefrag">pig-0.10.1.tar.gz/pig-0.10.1/bin/pig</span></td>
    <td colspan="1" rowspan="1">The path to the Pig executable.</td>
  
</tr>

  
<tr>
    
<td colspan="1" rowspan="1"><strong>templeton.hive.archive</strong></td>
    <td colspan="1" rowspan="1"><span class="codefrag">hdfs:///apps/templeton/hive-0.10.0.tar.gz</span></td>
    <td colspan="1" rowspan="1">The path to the Hive archive.</td>
  
</tr>

  
<tr>
    
<td colspan="1" rowspan="1"><strong>templeton.hive.path</strong></td>
    <td colspan="1" rowspan="1"><span class="codefrag">hive-0.10.0.tar.gz/hive-0.10.0/bin/hive</span></td>
    <td colspan="1" rowspan="1">The path to the Hive executable.</td>
  
</tr>

  
<tr>
    
<td colspan="1" rowspan="1"><strong>templeton.streaming.jar</strong></td>
    <td colspan="1" rowspan="1"><span class="codefrag">hdfs:///apps/templeton/hadoop-streaming.jar</span></td>
    <td colspan="1" rowspan="1">The path to the Hadoop streaming jar file.</td>
  
</tr>

  
<tr>
    
<td colspan="1" rowspan="1"><strong>templeton.override.jars</strong></td>
    <td colspan="1" rowspan="1"><span class="codefrag">hdfs:///apps/templeton/ugi.jar</span></td>
    <td colspan="1" rowspan="1">Jars to add to the HADOOP_CLASSPATH for all Map Reduce jobs.
        These jars must exist on HDFS.</td>
  
</tr>
  
</table>
</div>

  
<a name="Permissions"></a>
<h2 class="h3">Permissions</h2>
<div class="section">
<p>
    Permission must given for the user running the templeton
    executable to run jobs for other users.  That is, the templeton
    server will impersonate users on the Hadoop cluster.
  </p>
<p>
    Create (or assign) a Unix user who will run the Templeton server.
    Call this USER.  See the Secure Cluster section below for choosing
    a user on a Kerberos cluster.
  </p>
<p>
    Modify the Hadoop core-site.xml file and set these properties:
  </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
    
<tr>
<th colspan="1" rowspan="1">Variable</th><th colspan="1" rowspan="1">Value</th>
</tr>
    
<tr>
      
<td colspan="1" rowspan="1">hadoop.proxyuser.USER.groups</td>
      <td colspan="1" rowspan="1">
        A comma separated list of the Unix groups whose users will be
        impersonated.
      </td>
    
</tr>
    
<tr>
      
<td colspan="1" rowspan="1">hadoop.proxyuser.USER.hosts</td>
      <td colspan="1" rowspan="1">
        A comma separated list of the hosts that will run the hcat and
        JobTracker servers.
      </td>
    
</tr>
  
</table>
</div>

  
<a name="Secure+Cluster"></a>
<h2 class="h3">Secure Cluster</h2>
<div class="section">
<p>
    To run Templeton on a secure cluster follow the Permissions
    instructions above but create a Kerberos principal for the
    Templeton server with the name <span class="codefrag">USER/host@realm</span>
  
</p>
<p>
    Also, set the templeton configuration variables
    <span class="codefrag">templeton.kerberos.principal</span> and
    <span class="codefrag">templeton.kerberos.keytab</span>
  
</p>
</div>

  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2012-2013 <a href="http://www.apache.org/licenses/">The Apache Software Foundation</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
