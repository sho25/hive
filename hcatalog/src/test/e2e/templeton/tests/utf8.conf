# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

###############################################################################
# curl command tests for templeton
#
#
use utf8;

$cfg = 
{
 'driver' => 'Curl',

 'groups' => 
 [
##=============================================================================================================
  {
   'name' => 'Hive_UTF8',
   'tests' => 
   [
    {
    # Submitting Hive job with Unicode content on Unicode data
     'num' => 1,
     'method' => 'POST',
     'url' => ':TEMPLETON_URL:/templeton/v1/hive',
     'post_options' => ['user.name=:UNAME:','execute=drop table if exists utf8_table;create table utf8_table(row int, content string) ROW FORMAT DELIMITED FIELDS TERMINATED BY \'\t\';LOAD DATA INPATH \':INPDIR_HDFS:/table1.txt\' OVERWRITE INTO TABLE utf8_table;','statusdir=:OUTDIR:/status/Hive_UTF8_:TNUM:'],
     'json_field_substr_match' => { 'id' => '\d+'},
                                #results
     'status_code' => 200,
     'check_job_created' => 1,
     'check_job_complete' => 'SUCCESS',
     'check_job_exit_value' => 0,
     'check_call_back' => 1,
    },
   ]
  },
##=============================================================================================================
  {
   'name' => 'Pig_UTF8',
   'tests' => 
   [
    {
    # Submitting Pig job with Unicode content on Unicode data
     'num' => 1,
     'method' => 'POST',
     'url' => ':TEMPLETON_URL:/templeton/v1/pig',
     'post_options' => ['user.name=:UNAME:','file=:INPDIR_HDFS:/PigJoin䶴ㄩ鼾丄狜〇work.pig','arg=-p', 'arg=INPDIR=:INPDIR_HDFS:','arg=-p','arg=OUTDIR=:OUTDIR:','statusdir=:OUTDIR:/status/Pig_UTF8_:TNUM:'],
     'json_field_substr_match' => { 'id' => '\d+'},
                                #results
     'status_code' => 200,
     'check_job_created' => 1,
     'check_job_complete' => 'SUCCESS',
     'check_call_back' => 1, 
    },
   ]
  },
##=============================================================================================================
  {
   'name' => 'MapReduce_UTF8',
   'tests' => 
   [
    {
         
     'num' => 1,
     'method' => 'POST',
     'url' => ':TEMPLETON_URL:/templeton/v1/mapreduce/jar',
     'post_options' => ['user.name=:UNAME:','arg=:INPDIR_HDFS:/artof䶴ㄩ鼾丄狜〇war.txt', 'arg= :OUTDIR:/utf8_wc.txt', 
                        'jar=:INPDIR_HDFS:/hadoop_examples_䶴ㄩ鼾丄狜〇_2_2_0.jar', 'class=wordcount','statusdir=:OUTDIR:/status/MapRed_UTF8_:TNUM:'],
     'json_field_substr_match' => { 'id' => '\d+'},
                                #results
     'status_code' => 200,
     'check_job_created' => 1,
     'check_job_complete' => 'SUCCESS',
     'check_job_percent_complete' => 'map 100% reduce 100%',
     'check_job_exit_value' => 0,
     'check_call_back' => 1,
    }, 
   ]
  }, 
##=============================================================================================================
  {
   'name' => 'MapRedStreaming_UTF8',
   'tests' => 
   [
    {
     'num' => 1,
     'method' => 'POST',
     'url' => ':TEMPLETON_URL:/templeton/v1/mapreduce/streaming',
     'post_options' => ['user.name=:UNAME:','input=:INPDIR_HDFS:/artof䶴ㄩ鼾丄狜〇war.txt', 'input=:INPDIR_HDFS:/artof䶴ㄩ鼾丄狜〇war.txt', 'output=:OUTDIR:/MapRedStreaming_UTF8_count', 'mapper=cat', 'reducer=wc','statusdir=:OUTDIR:/status/MapRedStreaming_UTF8_:TNUM:'],
     'json_field_substr_match' => { 'id' => '\d+'},
                                #results
     'status_code' => 200,
     'check_job_created' => 1,
     'check_job_complete' => 'SUCCESS',
     'check_job_exit_value' => 0,
     'check_call_back' => 1,
    },
   ]
  },
##=============================================================================================================

  {
   'name' => 'JobFiltering_UTF8',
   'tests' => 
   [
    {
     'num' => 1,
     'depends_on' => 'Pig_UTF8',
     'method' => 'GET',
     'url' => ':TEMPLETON_URL:/templeton/v1/jobs?user.name=:UNAME:&showall=true&fields=*',
     'user_name' => ':UNAME:',
     'format_header' => 'Content-Type: application/json',
     'filter_job_names' => ['TempletonControllerJob', 'PigLatin:PigJoin䶴ㄩ鼾丄狜〇work.pig'],
     'status_code' => 200,
    },
   ]
  },
 ]
},
  ;