begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/**  * Licensed to the Apache Software Foundation (ASF) under one  * or more contributor license agreements.  See the NOTICE file  * distributed with this work for additional information  * regarding copyright ownership.  The ASF licenses this file  * to you under the Apache License, Version 2.0 (the  * "License"); you may not use this file except in compliance  * with the License.  You may obtain a copy of the License at  *  *     http://www.apache.org/licenses/LICENSE-2.0  *  * Unless required by applicable law or agreed to in writing, software  * distributed under the License is distributed on an "AS IS" BASIS,  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  * See the License for the specific language governing permissions and  * limitations under the License.  */
end_comment

begin_package
package|package
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|sqlstd
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Arrays
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Collection
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Collections
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Locale
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Map
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Set
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|IMetaStoreClient
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|HiveObjectPrivilege
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|HiveObjectRef
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|HiveObjectType
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|MetaException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|NoSuchObjectException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|PrincipalPrivilegeSet
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|PrivilegeBag
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|PrivilegeGrantInfo
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|metastore
operator|.
name|api
operator|.
name|Table
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|metadata
operator|.
name|HiveException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|AuthorizationUtils
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|HiveAccessControlException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|HiveAuthzPluginException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|HivePrincipal
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|HivePrivilege
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|HivePrivilegeObject
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|hadoop
operator|.
name|hive
operator|.
name|ql
operator|.
name|security
operator|.
name|authorization
operator|.
name|plugin
operator|.
name|HivePrivilegeObject
operator|.
name|HivePrivilegeObjectType
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|thrift
operator|.
name|TException
import|;
end_import

begin_class
specifier|public
class|class
name|SQLAuthorizationUtils
block|{
specifier|private
specifier|static
specifier|final
name|String
index|[]
name|SUPPORTED_PRIVS
init|=
block|{
literal|"INSERT"
block|,
literal|"UPDATE"
block|,
literal|"DELETE"
block|,
literal|"SELECT"
block|}
decl_stmt|;
specifier|private
specifier|static
specifier|final
name|Set
argument_list|<
name|String
argument_list|>
name|SUPPORTED_PRIVS_SET
init|=
operator|new
name|HashSet
argument_list|<
name|String
argument_list|>
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|SUPPORTED_PRIVS
argument_list|)
argument_list|)
decl_stmt|;
comment|/**    * Create thrift privileges bag    *    * @param hivePrincipals    * @param hivePrivileges    * @param hivePrivObject    * @param grantorPrincipal    * @param grantOption    * @return    * @throws HiveAuthzPluginException    */
specifier|static
name|PrivilegeBag
name|getThriftPrivilegesBag
parameter_list|(
name|List
argument_list|<
name|HivePrincipal
argument_list|>
name|hivePrincipals
parameter_list|,
name|List
argument_list|<
name|HivePrivilege
argument_list|>
name|hivePrivileges
parameter_list|,
name|HivePrivilegeObject
name|hivePrivObject
parameter_list|,
name|HivePrincipal
name|grantorPrincipal
parameter_list|,
name|boolean
name|grantOption
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
name|HiveObjectRef
name|privObj
init|=
name|getThriftHiveObjectRef
argument_list|(
name|hivePrivObject
argument_list|)
decl_stmt|;
name|PrivilegeBag
name|privBag
init|=
operator|new
name|PrivilegeBag
argument_list|()
decl_stmt|;
for|for
control|(
name|HivePrivilege
name|privilege
range|:
name|hivePrivileges
control|)
block|{
if|if
condition|(
name|privilege
operator|.
name|getColumns
argument_list|()
operator|!=
literal|null
operator|&&
name|privilege
operator|.
name|getColumns
argument_list|()
operator|.
name|size
argument_list|()
operator|>
literal|0
condition|)
block|{
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
literal|"Privileges on columns not supported currently"
operator|+
literal|" in sql standard authorization mode"
argument_list|)
throw|;
block|}
if|if
condition|(
operator|!
name|SUPPORTED_PRIVS_SET
operator|.
name|contains
argument_list|(
name|privilege
operator|.
name|getName
argument_list|()
operator|.
name|toUpperCase
argument_list|(
name|Locale
operator|.
name|US
argument_list|)
argument_list|)
condition|)
block|{
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
literal|"Privilege: "
operator|+
name|privilege
operator|.
name|getName
argument_list|()
operator|+
literal|" is not supported in sql standard authorization mode"
argument_list|)
throw|;
block|}
name|PrivilegeGrantInfo
name|grantInfo
init|=
name|getThriftPrivilegeGrantInfo
argument_list|(
name|privilege
argument_list|,
name|grantorPrincipal
argument_list|,
name|grantOption
argument_list|)
decl_stmt|;
for|for
control|(
name|HivePrincipal
name|principal
range|:
name|hivePrincipals
control|)
block|{
name|HiveObjectPrivilege
name|objPriv
init|=
operator|new
name|HiveObjectPrivilege
argument_list|(
name|privObj
argument_list|,
name|principal
operator|.
name|getName
argument_list|()
argument_list|,
name|AuthorizationUtils
operator|.
name|getThriftPrincipalType
argument_list|(
name|principal
operator|.
name|getType
argument_list|()
argument_list|)
argument_list|,
name|grantInfo
argument_list|)
decl_stmt|;
name|privBag
operator|.
name|addToPrivileges
argument_list|(
name|objPriv
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|privBag
return|;
block|}
specifier|static
name|PrivilegeGrantInfo
name|getThriftPrivilegeGrantInfo
parameter_list|(
name|HivePrivilege
name|privilege
parameter_list|,
name|HivePrincipal
name|grantorPrincipal
parameter_list|,
name|boolean
name|grantOption
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
try|try
block|{
return|return
name|AuthorizationUtils
operator|.
name|getThriftPrivilegeGrantInfo
argument_list|(
name|privilege
argument_list|,
name|grantorPrincipal
argument_list|,
name|grantOption
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|HiveException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
name|e
argument_list|)
throw|;
block|}
block|}
comment|/**    * Create a thrift privilege object from the plugin interface privilege object    *    * @param privObj    * @return    * @throws HiveAuthzPluginException    */
specifier|static
name|HiveObjectRef
name|getThriftHiveObjectRef
parameter_list|(
name|HivePrivilegeObject
name|privObj
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
try|try
block|{
return|return
name|AuthorizationUtils
operator|.
name|getThriftHiveObjectRef
argument_list|(
name|privObj
argument_list|)
return|;
block|}
catch|catch
parameter_list|(
name|HiveException
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
name|e
argument_list|)
throw|;
block|}
block|}
specifier|static
name|HivePrivilegeObjectType
name|getPluginObjType
parameter_list|(
name|HiveObjectType
name|objectType
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
switch|switch
condition|(
name|objectType
condition|)
block|{
case|case
name|DATABASE
case|:
return|return
name|HivePrivilegeObjectType
operator|.
name|DATABASE
return|;
case|case
name|TABLE
case|:
return|return
name|HivePrivilegeObjectType
operator|.
name|TABLE
return|;
case|case
name|COLUMN
case|:
case|case
name|GLOBAL
case|:
case|case
name|PARTITION
case|:
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
literal|"Unsupported object type "
operator|+
name|objectType
argument_list|)
throw|;
default|default:
throw|throw
operator|new
name|AssertionError
argument_list|(
literal|"Unexpected object type "
operator|+
name|objectType
argument_list|)
throw|;
block|}
block|}
comment|/**    * Check if the privileges are acceptable for SQL Standard authorization implementation    * @param hivePrivileges    * @throws HiveAuthzPluginException    */
specifier|public
specifier|static
name|void
name|validatePrivileges
parameter_list|(
name|List
argument_list|<
name|HivePrivilege
argument_list|>
name|hivePrivileges
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
for|for
control|(
name|HivePrivilege
name|hivePrivilege
range|:
name|hivePrivileges
control|)
block|{
if|if
condition|(
name|hivePrivilege
operator|.
name|getColumns
argument_list|()
operator|!=
literal|null
operator|&&
name|hivePrivilege
operator|.
name|getColumns
argument_list|()
operator|.
name|size
argument_list|()
operator|!=
literal|0
condition|)
block|{
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
literal|"Privilege with columns are not currently supported with sql standard authorization:"
operator|+
name|hivePrivilege
argument_list|)
throw|;
block|}
comment|//try converting to the enum to verify that this is a valid privilege type
name|SQLPrivilegeType
operator|.
name|getRequirePrivilege
argument_list|(
name|hivePrivilege
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**    * Get the privileges this user(userName argument) has on the object    * (hivePrivObject argument)    *    * @param metastoreClient    * @param userName    * @param hivePrivObject    * @return    * @throws HiveAuthzPluginException    */
specifier|static
name|RequiredPrivileges
name|getPrivilegesFromMetaStore
parameter_list|(
name|IMetaStoreClient
name|metastoreClient
parameter_list|,
name|String
name|userName
parameter_list|,
name|HivePrivilegeObject
name|hivePrivObject
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
comment|// get privileges for this user and its role on this object
name|PrincipalPrivilegeSet
name|thrifPrivs
init|=
literal|null
decl_stmt|;
try|try
block|{
name|thrifPrivs
operator|=
name|metastoreClient
operator|.
name|get_privilege_set
argument_list|(
name|AuthorizationUtils
operator|.
name|getThriftHiveObjectRef
argument_list|(
name|hivePrivObject
argument_list|)
argument_list|,
name|userName
argument_list|,
literal|null
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|MetaException
name|e
parameter_list|)
block|{
name|throwGetPrivErr
argument_list|(
name|e
argument_list|,
name|hivePrivObject
argument_list|,
name|userName
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TException
name|e
parameter_list|)
block|{
name|throwGetPrivErr
argument_list|(
name|e
argument_list|,
name|hivePrivObject
argument_list|,
name|userName
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|HiveException
name|e
parameter_list|)
block|{
name|throwGetPrivErr
argument_list|(
name|e
argument_list|,
name|hivePrivObject
argument_list|,
name|userName
argument_list|)
expr_stmt|;
block|}
comment|// convert to RequiredPrivileges
name|RequiredPrivileges
name|privs
init|=
name|getRequiredPrivsFromThrift
argument_list|(
name|thrifPrivs
argument_list|)
decl_stmt|;
comment|// add owner privilege if user is owner of the object
if|if
condition|(
name|isOwner
argument_list|(
name|metastoreClient
argument_list|,
name|userName
argument_list|,
name|hivePrivObject
argument_list|)
condition|)
block|{
name|privs
operator|.
name|addPrivilege
argument_list|(
name|SQLPrivTypeGrant
operator|.
name|OWNER_PRIV
argument_list|)
expr_stmt|;
block|}
return|return
name|privs
return|;
block|}
comment|/**    * Check if user is owner of the given object    *    * @param metastoreClient    * @param userName    *          user    * @param hivePrivObject    *          given object    * @return true if user is owner    * @throws HiveAuthzPluginException    */
specifier|private
specifier|static
name|boolean
name|isOwner
parameter_list|(
name|IMetaStoreClient
name|metastoreClient
parameter_list|,
name|String
name|userName
parameter_list|,
name|HivePrivilegeObject
name|hivePrivObject
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
comment|//for now, check only table
if|if
condition|(
name|hivePrivObject
operator|.
name|getType
argument_list|()
operator|==
name|HivePrivilegeObjectType
operator|.
name|TABLE
condition|)
block|{
name|Table
name|thriftTableObj
init|=
literal|null
decl_stmt|;
try|try
block|{
name|thriftTableObj
operator|=
name|metastoreClient
operator|.
name|getTable
argument_list|(
name|hivePrivObject
operator|.
name|getDbname
argument_list|()
argument_list|,
name|hivePrivObject
operator|.
name|getTableviewname
argument_list|()
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|MetaException
name|e
parameter_list|)
block|{
name|throwGetTableErr
argument_list|(
name|e
argument_list|,
name|hivePrivObject
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|NoSuchObjectException
name|e
parameter_list|)
block|{
name|throwGetTableErr
argument_list|(
name|e
argument_list|,
name|hivePrivObject
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TException
name|e
parameter_list|)
block|{
name|throwGetTableErr
argument_list|(
name|e
argument_list|,
name|hivePrivObject
argument_list|)
expr_stmt|;
block|}
return|return
name|userName
operator|.
name|equals
argument_list|(
name|thriftTableObj
operator|.
name|getOwner
argument_list|()
argument_list|)
return|;
block|}
return|return
literal|false
return|;
block|}
specifier|private
specifier|static
name|void
name|throwGetTableErr
parameter_list|(
name|Exception
name|e
parameter_list|,
name|HivePrivilegeObject
name|hivePrivObject
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
name|String
name|msg
init|=
literal|"Error getting table object from metastore for"
operator|+
name|hivePrivObject
decl_stmt|;
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
name|msg
argument_list|,
name|e
argument_list|)
throw|;
block|}
specifier|private
specifier|static
name|void
name|throwGetPrivErr
parameter_list|(
name|Exception
name|e
parameter_list|,
name|HivePrivilegeObject
name|hivePrivObject
parameter_list|,
name|String
name|userName
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
name|String
name|msg
init|=
literal|"Error getting privileges on "
operator|+
name|hivePrivObject
operator|+
literal|" for "
operator|+
name|userName
decl_stmt|;
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
name|msg
argument_list|,
name|e
argument_list|)
throw|;
block|}
specifier|private
specifier|static
name|RequiredPrivileges
name|getRequiredPrivsFromThrift
parameter_list|(
name|PrincipalPrivilegeSet
name|thrifPrivs
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
name|RequiredPrivileges
name|reqPrivs
init|=
operator|new
name|RequiredPrivileges
argument_list|()
decl_stmt|;
comment|// add user privileges
name|Map
argument_list|<
name|String
argument_list|,
name|List
argument_list|<
name|PrivilegeGrantInfo
argument_list|>
argument_list|>
name|userPrivs
init|=
name|thrifPrivs
operator|.
name|getUserPrivileges
argument_list|()
decl_stmt|;
if|if
condition|(
name|userPrivs
operator|!=
literal|null
operator|&&
name|userPrivs
operator|.
name|size
argument_list|()
operator|!=
literal|1
condition|)
block|{
throw|throw
operator|new
name|HiveAuthzPluginException
argument_list|(
literal|"Invalid number of user privilege objects: "
operator|+
name|userPrivs
operator|.
name|size
argument_list|()
argument_list|)
throw|;
block|}
name|addRequiredPrivs
argument_list|(
name|reqPrivs
argument_list|,
name|userPrivs
argument_list|)
expr_stmt|;
comment|// add role privileges
name|Map
argument_list|<
name|String
argument_list|,
name|List
argument_list|<
name|PrivilegeGrantInfo
argument_list|>
argument_list|>
name|rolePrivs
init|=
name|thrifPrivs
operator|.
name|getRolePrivileges
argument_list|()
decl_stmt|;
name|addRequiredPrivs
argument_list|(
name|reqPrivs
argument_list|,
name|rolePrivs
argument_list|)
expr_stmt|;
return|return
name|reqPrivs
return|;
block|}
comment|/**    * Add privileges to RequiredPrivileges object reqPrivs from thrift availPrivs    * object    * @param reqPrivs    * @param availPrivs    * @throws HiveAuthzPluginException    */
specifier|private
specifier|static
name|void
name|addRequiredPrivs
parameter_list|(
name|RequiredPrivileges
name|reqPrivs
parameter_list|,
name|Map
argument_list|<
name|String
argument_list|,
name|List
argument_list|<
name|PrivilegeGrantInfo
argument_list|>
argument_list|>
name|availPrivs
parameter_list|)
throws|throws
name|HiveAuthzPluginException
block|{
if|if
condition|(
name|availPrivs
operator|==
literal|null
condition|)
block|{
return|return;
block|}
for|for
control|(
name|Map
operator|.
name|Entry
argument_list|<
name|String
argument_list|,
name|List
argument_list|<
name|PrivilegeGrantInfo
argument_list|>
argument_list|>
name|userPriv
range|:
name|availPrivs
operator|.
name|entrySet
argument_list|()
control|)
block|{
name|List
argument_list|<
name|PrivilegeGrantInfo
argument_list|>
name|userPrivGInfos
init|=
name|userPriv
operator|.
name|getValue
argument_list|()
decl_stmt|;
for|for
control|(
name|PrivilegeGrantInfo
name|userPrivGInfo
range|:
name|userPrivGInfos
control|)
block|{
name|reqPrivs
operator|.
name|addPrivilege
argument_list|(
name|userPrivGInfo
operator|.
name|getPrivilege
argument_list|()
argument_list|,
name|userPrivGInfo
operator|.
name|isGrantOption
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
specifier|public
specifier|static
name|void
name|assertNoMissingPrivilege
parameter_list|(
name|Collection
argument_list|<
name|SQLPrivTypeGrant
argument_list|>
name|missingPrivs
parameter_list|,
name|HivePrincipal
name|hivePrincipal
parameter_list|,
name|HivePrivilegeObject
name|hivePrivObject
parameter_list|)
throws|throws
name|HiveAccessControlException
block|{
if|if
condition|(
name|missingPrivs
operator|.
name|size
argument_list|()
operator|!=
literal|0
condition|)
block|{
comment|// there are some required privileges missing, create error message
comment|// sort the privileges so that error message is deterministic (for tests)
name|List
argument_list|<
name|SQLPrivTypeGrant
argument_list|>
name|sortedmissingPrivs
init|=
operator|new
name|ArrayList
argument_list|<
name|SQLPrivTypeGrant
argument_list|>
argument_list|(
name|missingPrivs
argument_list|)
decl_stmt|;
name|Collections
operator|.
name|sort
argument_list|(
name|sortedmissingPrivs
argument_list|)
expr_stmt|;
name|String
name|errMsg
init|=
literal|"Permission denied. "
operator|+
name|hivePrincipal
operator|+
literal|" does not have following privileges on "
operator|+
name|hivePrivObject
operator|+
literal|" : "
operator|+
name|sortedmissingPrivs
decl_stmt|;
throw|throw
operator|new
name|HiveAccessControlException
argument_list|(
name|errMsg
operator|.
name|toString
argument_list|()
argument_list|)
throw|;
block|}
block|}
block|}
end_class

end_unit

